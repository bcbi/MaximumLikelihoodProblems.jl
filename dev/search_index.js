var documenterSearchIndex = {"docs":
[{"location":"logistic_regression/#","page":"Logistic regression","title":"Logistic regression","text":"EditURL = \"https://github.com/bcbi/MaximumLikelihoodProblems.jl/blob/master/examples/logistic_regression.jl\"","category":"page"},{"location":"logistic_regression/#Logistic-regression-1","page":"Logistic regression","title":"Logistic regression","text":"","category":"section"},{"location":"logistic_regression/#","page":"Logistic regression","title":"Logistic regression","text":"import MaximumLikelihoodProblems\n\nimport Distributions\nimport ForwardDiff\nimport LogDensityProblems\nimport Parameters\nimport StatsFuns\nimport TransformVariables\n\nstruct LogisticRegression{Ty, TX}\n    y::Ty\n    X::TX\nend\n\nfunction (problem::LogisticRegression)(θ)\n    Parameters.@unpack y, X = problem\n    Parameters.@unpack β = θ\n    η = X*β\n    μ = StatsFuns.logistic.(η)\n    loglik = sum(Distributions.logpdf.(Distributions.Bernoulli.(μ), y))\n    return loglik\nend\n\nN = 10_000\nX = hcat(ones(N), randn(N))\nsize_β = (2,)\nβ_true = [1.0, 2.0]\nη_true = X * β_true\nμ_true = StatsFuns.logistic.(η_true)\ny = rand.(Distributions.Bernoulli.(μ_true))\n\nproblem = LogisticRegression(y, X)\ntransformation = TransformVariables.as((β = TransformVariables.as(Array, size_β), ))\ntransformed_problem = LogDensityProblems.TransformedLogDensity(transformation,\n                                                               problem)\ntransformed_gradient_problem = LogDensityProblems.ADgradient(:ForwardDiff,\n                                                             transformed_problem)\n\nβ_hat_initial_guess = zeros(size_β)\nθ_hat_initial = (; β = β_hat_initial_guess)","category":"page"},{"location":"logistic_regression/#","page":"Logistic regression","title":"Logistic regression","text":"θ_hat:","category":"page"},{"location":"logistic_regression/#","page":"Logistic regression","title":"Logistic regression","text":"θ_hat = MaximumLikelihoodProblems.fit(transformed_gradient_problem,\n                                      θ_hat_initial)","category":"page"},{"location":"logistic_regression/#","page":"Logistic regression","title":"Logistic regression","text":"β_hat:","category":"page"},{"location":"logistic_regression/#","page":"Logistic regression","title":"Logistic regression","text":"β_hat = θ_hat[:β]","category":"page"},{"location":"logistic_regression/#","page":"Logistic regression","title":"Logistic regression","text":"","category":"page"},{"location":"logistic_regression/#","page":"Logistic regression","title":"Logistic regression","text":"This page was generated using Literate.jl.","category":"page"},{"location":"multinomial_logistic_regression/#","page":"Multinomial logistic regression","title":"Multinomial logistic regression","text":"EditURL = \"https://github.com/bcbi/MaximumLikelihoodProblems.jl/blob/master/examples/multinomial_logistic_regression.jl\"","category":"page"},{"location":"multinomial_logistic_regression/#Multinomial-logistic-regression-1","page":"Multinomial logistic regression","title":"Multinomial logistic regression","text":"","category":"section"},{"location":"multinomial_logistic_regression/#","page":"Multinomial logistic regression","title":"Multinomial logistic regression","text":"import MaximumLikelihoodProblems\n\nimport Distributions\nimport ForwardDiff\nimport LogDensityProblems\nimport Parameters\nimport NNlib\nimport TransformVariables\n\nstruct MultinomialLogisticRegression{Ty, TX}\n    y::Ty\n    X::TX\nend\n\nfunction (problem::MultinomialLogisticRegression)(θ)\n    Parameters.@unpack y, X = problem\n    Parameters.@unpack β = θ\n    num_rows, num_covariates = size(X)\n    num_classes = size(β, 2) + 1\n\n    # the first column of all zeros corresponds to the base class\n    η = X * hcat(zeros(num_covariates), β)\n\n    μ = NNlib.softmax(η; dims=2)\n    loglik = sum([Distributions.logpdf(Distributions.Multinomial(1, μ[i, :]), y[i, :]) for i = 1:num_rows])\n    return loglik\nend\n\nN = 10_000\nX = hcat(ones(N), randn(N))\nsize_β = (2, 3)\nβ_true = [1.0 2.0 3.0; 4.0 5.0 6.0]\nη_true = X * hcat(zeros(2), β_true)\nμ_true = NNlib.softmax(η_true; dims=2)\ny = vcat([rand(Distributions.Multinomial(1, μ_true[i,:]))' for i in 1:N]...)\n\nproblem = MultinomialLogisticRegression(y, X)\ntransformation = TransformVariables.as((β = TransformVariables.as(Array, size_β), ))\ntransformed_problem = LogDensityProblems.TransformedLogDensity(transformation,\n                                                               problem)\ntransformed_gradient_problem = LogDensityProblems.ADgradient(:ForwardDiff,\n                                                             transformed_problem)\n\nβ_hat_initial_guess = zeros(size_β)\nθ_hat_initial = (; β = β_hat_initial_guess)","category":"page"},{"location":"multinomial_logistic_regression/#","page":"Multinomial logistic regression","title":"Multinomial logistic regression","text":"θ_hat:","category":"page"},{"location":"multinomial_logistic_regression/#","page":"Multinomial logistic regression","title":"Multinomial logistic regression","text":"θ_hat = MaximumLikelihoodProblems.fit(transformed_gradient_problem,\n                                      θ_hat_initial;\n                                      show_progress_meter = false)","category":"page"},{"location":"multinomial_logistic_regression/#","page":"Multinomial logistic regression","title":"Multinomial logistic regression","text":"β_hat:","category":"page"},{"location":"multinomial_logistic_regression/#","page":"Multinomial logistic regression","title":"Multinomial logistic regression","text":"β_hat = θ_hat[:β]","category":"page"},{"location":"multinomial_logistic_regression/#","page":"Multinomial logistic regression","title":"Multinomial logistic regression","text":"","category":"page"},{"location":"multinomial_logistic_regression/#","page":"Multinomial logistic regression","title":"Multinomial logistic regression","text":"This page was generated using Literate.jl.","category":"page"},{"location":"#MaximumLikelihoodProblems.jl-1","page":"Home","title":"MaximumLikelihoodProblems.jl","text":"","category":"section"},{"location":"#","page":"Home","title":"Home","text":"","category":"page"},{"location":"#","page":"Home","title":"Home","text":"Modules = [MaximumLikelihoodProblems]","category":"page"},{"location":"linear_regression/#","page":"Linear regression","title":"Linear regression","text":"EditURL = \"https://github.com/bcbi/MaximumLikelihoodProblems.jl/blob/master/examples/linear_regression.jl\"","category":"page"},{"location":"linear_regression/#Linear-regression-1","page":"Linear regression","title":"Linear regression","text":"","category":"section"},{"location":"linear_regression/#","page":"Linear regression","title":"Linear regression","text":"import MaximumLikelihoodProblems\n\nimport Distributions\nimport ForwardDiff\nimport LogDensityProblems\nimport Parameters\nimport TransformVariables\n\nstruct LinearRegression{Ty, TX}\n    y::Ty\n    X::TX\nend\n\nfunction (problem::LinearRegression)(θ)\n    Parameters.@unpack y, X = problem\n    Parameters.@unpack β, σ = θ\n    η = X*β\n    μ = η\n    ε = y - μ\n\n    # these two lines are equivalent:\n    # loglik = Distributions.loglikelihood(Distributions.Normal(0, σ), ε)\n    # loglik = sum(Distributions.logpdf.(Distributions.Normal(0, σ), ε))\n\n    loglik = sum(Distributions.logpdf.(Distributions.Normal(0, σ), ε))\n    return loglik\nend\n\nN = 10_000\nX = hcat(ones(N), randn(N, 2))\nsize_β = (3,)\nβ_true = [1.0, 2.0, -1.0]\nσ_true = 0.5\nη_true = X * β_true\nμ_true = η_true\nε_true = randn(N) .* σ_true\ny = μ_true + ε_true\n\nfunction generate_problem_transformation(p::LinearRegression)\n    return TransformVariables.as((β = TransformVariables.as(Array, size(p.X, 2)),\n                                  σ = TransformVariables.asℝ₊))\nend\n\nproblem = LinearRegression(y, X)\ntransformation = generate_problem_transformation(problem)\ntransformed_problem = LogDensityProblems.TransformedLogDensity(transformation,\n                                                               problem)\ntransformed_gradient_problem = LogDensityProblems.ADgradient(:ForwardDiff,\n                                                             transformed_problem)\n\nβ_hat_initial_guess = zeros(size_β)\nσ_hat_initial_guess = 1.0\n\nθ_hat_initial = (; β = β_hat_initial_guess,\n                   σ = σ_hat_initial_guess)","category":"page"},{"location":"linear_regression/#","page":"Linear regression","title":"Linear regression","text":"θ_hat:","category":"page"},{"location":"linear_regression/#","page":"Linear regression","title":"Linear regression","text":"θ_hat = MaximumLikelihoodProblems.fit(transformed_gradient_problem,\n                                      θ_hat_initial;\n                                      learning_rate = 1e-6)","category":"page"},{"location":"linear_regression/#","page":"Linear regression","title":"Linear regression","text":"β_hat:","category":"page"},{"location":"linear_regression/#","page":"Linear regression","title":"Linear regression","text":"β_hat = θ_hat[:β]","category":"page"},{"location":"linear_regression/#","page":"Linear regression","title":"Linear regression","text":"σ_hat:","category":"page"},{"location":"linear_regression/#","page":"Linear regression","title":"Linear regression","text":"σ_hat = θ_hat[:σ]","category":"page"},{"location":"linear_regression/#","page":"Linear regression","title":"Linear regression","text":"","category":"page"},{"location":"linear_regression/#","page":"Linear regression","title":"Linear regression","text":"This page was generated using Literate.jl.","category":"page"}]
}
